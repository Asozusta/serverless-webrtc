webpackJsonp([1,0],[function(e,o,a){"use strict";function t(e){return e&&e.__esModule?e:{"default":e}}var n=a(13),d=t(n),i=a(11),l=t(i);new d["default"]({el:"body",components:{App:l["default"]}})},function(e,o,a){e.exports=a.p+"static/img/spinner.9c1bc71.gif"},function(e,o,a){"use strict";function t(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(o,"__esModule",{value:!0});var n=a(12),d=t(n);o["default"]={components:{Chat:d["default"]}}},function(e,o,a){"use strict";function t(e){return e&&e.__esModule?e:{"default":e}}function n(){navigator.mozGetUserMedia?(console.log("This appears to be Firefox"),g="firefox",r=mozRTCPeerConnection,c=mozRTCSessionDescription,v=mozRTCIceCandidate,u=navigator.mozGetUserMedia.bind(navigator),m=function(e,o){console.log("Attaching media stream"),e.mozSrcObject=o,e.play()},f=function(e,o){console.log("Reattaching media stream"),e.mozSrcObject=o.mozSrcObject,e.play()},MediaStream.prototype.getVideoTracks=function(){return[]},MediaStream.prototype.getAudioTracks=function(){return[]}):navigator.webkitGetUserMedia?(console.log("This appears to be Chrome or iOS using a shim"),g="chrome",r=webkitRTCPeerConnection,u=navigator.webkitGetUserMedia.bind(navigator),m=function(e,o){e.src=webkitURL.createObjectURL(o)},f=function(e,o){e.src=o.src},webkitMediaStream.prototype.getVideoTracks||(webkitMediaStream.prototype.getVideoTracks=function(){return this.videoTracks},webkitMediaStream.prototype.getAudioTracks=function(){return this.audioTracks}),webkitRTCPeerConnection.prototype.getLocalStreams||(webkitRTCPeerConnection.prototype.getLocalStreams=function(){return this.localStreams},webkitRTCPeerConnection.prototype.getRemoteStreams=function(){return this.remoteStreams})):alert("This browser doesn't support webRTC and cannot be used to chat")}function d(){h={iceServers:[{url:"stun:23.21.150.121"}]},p={optional:[{DtlsSrtpKeyAgreement:!0}]},w=new r(h,p),b=null,y=null,x=!1,k={optional:[],mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0}},R=function(e){console.log(e+" sent")},M=function(e){console.log(e+" progress")},S=function(e){e.size&&V.send({file:e,onFileSent:R,onFileProgress:M})},T=function(){try{var e=new H;b=w.createDataChannel("test",{reliable:!0}),_=b,console.log("Created datachannel (pc1)"),b.onopen=function(e){console.log("data channel connect"),$("#waitForConnection").modal("hide"),$("#waitForConnection").remove()},b.onmessage=function(o){if(console.log("Got message (pc1)",o.data),o.data.size)e.receive(o.data,{});else{if(2==o.data.charCodeAt(0))return;console.log(o);var a=JSON.parse(o.data);"file"===a.type?e.receive(o.data,{}):(N(a.message,"text-info"),$("#chatlog").scrollTop($("#chatlog")[0].scrollHeight))}}}catch(o){console.warn("No data channel (pc1)",o)}},C=function(){console.log("video1"),navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getUserMedia({video:!0,audio:!0},function(e){var o=document.getElementById("localVideo");o.src=window.URL.createObjectURL(e),o.play(),w.addStream(e),console.log(e),console.log("adding stream to pc1"),T(),w.createOffer(function(e){w.setLocalDescription(e,function(){},function(){}),console.log("created local offer",e)},function(){console.warn("Couldn't create offer")},k)},function(e){console.log("Error adding stream to pc1: "+e)})},w.onicecandidate=function(e){console.log("ICE candidate (pc1)",e),null==e.candidate&&$("#localOffer").html((0,s["default"])(w.localDescription))},O=function(e){console.log("Got remote stream",e.stream);var o=document.getElementById("remoteVideo");o.autoplay=!0,m(o,e.stream)},w.onaddstream=O,L=function(){console.log("Datachannel connected"),N("Datachannel connected","text-success"),$("#waitForConnection").modal("hide"),$("#waitForConnection").remove(),$("#showLocalAnswer").modal("hide"),$("#messageTextBox").focus(),$(".modal-backdrop").hide()},w.onconnection=L,B=function(e){console.info("signaling state change:",e)},A=function(e){console.info("ice connection state change:",e)},U=function(e){console.info("ice gathering state change:",e)},w.onsignalingstatechange=B,w.oniceconnectionstatechange=A,w.onicegatheringstatechange=U,F=function(e){console.log("Received remote answer: ",e),N("Received remote answer","text-success"),w.setRemoteDescription(e)},P=function(e){w.addIceCandidate(e)},z=new r(h,p),I=null,D=!1,z.ondatachannel=function(e){var o=new H,a=e.channel||e;console.log("Received datachannel (pc2)",arguments),I=a,_=I,I.onopen=function(e){console.log("data channel connect"),$("#waitForConnection").modal("hide"),$("#waitForConnection").remove()},I.onmessage=function(e){if(console.log("Got message (pc2)",e.data),e.data.size)o.receive(e.data,{});else{var a=JSON.parse(e.data);"file"===a.type?o.receive(e.data,{}):(N(a.message,"text-info"),$("#chatlog").scrollTop($("#chatlog")[0].scrollHeight))}}},E=function(e){z.setRemoteDescription(e),z.createAnswer(function(e){N("Created local answer","text-success"),console.log("Created local answer: ",e),z.setLocalDescription(e)},function(){console.warn("Couldn't create offer")},k)},z.onicecandidate=function(e){console.log("ICE candidate (pc2)",e),null==e.candidate&&$("#localAnswer").html((0,s["default"])(z.localDescription))},z.onsignalingstatechange=B,z.oniceconnectionstatechange=A,z.onicegatheringstatechange=U,G=function(e){z.addIceCandidate(e)},z.onaddstream=O,z.onconnection=L,j=function(){var e=(new Date).getTime()/1e3,o=parseInt(e/3600)%24,a=parseInt(e/60)%60,t=parseInt(e%60),n=(o<10?"0"+o:o)+":"+(a<10?"0"+a:a)+":"+(t<10?"0"+t:t);return n},N=function(e,o){document.getElementById("chatlog").innerHTML+='<p class="'+o+'">['+j()+"] "+e+"</p>"},window.moz=!!navigator.mozGetUserMedia,J=function(e){return{send:function(e){if(moz&&e.file)var o=e.file;else var o=(0,s["default"])(e);_.send(o)}}},V={send:function(e){function o(n,r){var c={type:"file"};n&&(r=n.target.result,l=s=c.packets=parseInt(r.length/d)),e.onFileProgress&&e.onFileProgress({remaining:s--,length:l,sent:l-s}),r.length>d?c.message=r.slice(0,d):(c.message=r,c.last=!0,c.name=t.name,e.onFileSent&&e.onFileSent(t)),a.send(c),i=r.slice(c.message.length),i.length&&setTimeout(function(){o(null,i)},500)}var a=e.channel||new J,t=e.file;if(moz&&(a.send({fileName:t.name,type:"file"}),a.send({file:t}),e.onFileSent&&e.onFileSent(t)),!moz){var n=new window.FileReader;n.readAsDataURL(t),n.onload=o}var d=1e3,i="",l=0,s=0}},H=function(){function e(e,d){if(moz)if(e.size){var i=new window.FileReader;i.readAsDataURL(e),i.onload=function(e){W.SaveToDisk(e.target.result,a),d.onFileReceived&&d.onFileReceived(a)}}else{var l=JSON.parse(e);l.fileName&&(a=l.fileName)}moz||(e.packets&&(n=t=parseInt(e.packets)),d.onFileProgress&&d.onFileProgress({remaining:t--,length:n,received:n-t}),o.push(e.message),e.last&&(W.SaveToDisk(o.join(""),e.name),d.onFileReceived&&d.onFileReceived(e.name),o=[]))}var o=[],a="",t=0,n=0;return{receive:e}},W={SaveToDisk:function(e,o){var a=document.createElement("a");a.href=e,a.target="_blank",a.download=o||e;var t=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});a.dispatchEvent(t),(window.URL||window.webkitURL).revokeObjectURL(a.href)}}}function i(){$("#showLocalOffer").modal("hide"),$("#getRemoteAnswer").modal("hide"),$("#waitForConnection").modal("hide"),$("#createOrJoin").modal("show"),$("#createBtn").click(function(){$("#showLocalOffer").modal("show"),C()}),$("#joinBtn").click(function(){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,navigator.getUserMedia({video:!0,audio:!0},function(e){var o=document.getElementById("localVideo");o.src=window.URL.createObjectURL(e),o.play(),z.addStream(e)},function(e){console.log("Error adding stream to pc2: "+e)}),$("#getRemoteOffer").modal("show")}),$("#offerSentBtn").click(function(){$("#getRemoteAnswer").modal("show")}),$("#offerRecdBtn").click(function(){var e=$("#remoteOffer").val(),o=new c(JSON.parse(e));console.log("Received remote offer",o),N("Received remote offer","text-success"),E(o),$("#showLocalAnswer").modal("show")}),$("#answerSentBtn").click(function(){$("#waitForConnection").modal("show")}),$("#answerRecdBtn").click(function(){var e=$("#remoteAnswer").val(),o=new c(JSON.parse(e));F(o),$("#waitForConnection").modal("show")}),$("#fileBtn").change(function(){var e=this.files[0];console.log(e),S(e)})}Object.defineProperty(o,"__esModule",{value:!0});var l=a(4),s=t(l);console.log("in chat");var r=null,c=null,v=null,u=null,m=null,f=null,g=null,h=null,p=null,w=null,b=null,y=null,_=null,x=null,k=null,R=null,M=null,S=null,T=null,C=null,O=null,L=null,B=null,A=null,U=null,F=null,P=null,z=null,I=null,D=null,E=null,G=null,j=null,N=null,J=null,V=null,H=null,W=null;navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry|IEMobile)/)?(console.log("cordova"),window.device?(console.log("script: device ready"),"iOS"===window.device.platform&&(console.log("iOS"),cordova.plugins.iosrtc.registerGlobals()),n(),d()):document.addEventListener("deviceready",function(){console.log("script: listener - device ready"),"iOS"===window.device.platform&&(console.log("iOS"),cordova.plugins.iosrtc.registerGlobals()),n(),d()})):(console.log("Not cordova"),n(),d()),o["default"]={data:function(){return{cordovaReady:!1}},created:function(){console.log("chat created");var e=this;navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry|IEMobile)/)?window.device?setTimeout(function(){e.deviceReady=!0},1e3):document.addEventListener("deviceready",function(){setTimeout(function(){e.deviceReady=!0},1e3)}):e.deviceReady=!0},ready:function(){navigator.userAgent.match(/(iPhone|iPod|iPad|Android|BlackBerry|IEMobile)/)?window.device?setTimeout(function(){i()},2e3):document.addEventListener("deviceready",function(){setTimeout(function(){i()},2e3)}):i()},methods:{sendMessage:function(){if($("#messageTextBox").val()){var e=new J;N($("#messageTextBox").val(),"text-success"),e.send({message:$("#messageTextBox").val()}),$("#messageTextBox").val(""),$("#chatlog").scrollTop($("#chatlog")[0].scrollHeight)}return!1}}}},,,,function(e,o){},function(e,o){},function(e,o){e.exports=" <div id=app> <chat></chat> </div> "},function(e,o,a){e.exports=' <div v-if=deviceReady class=container _v-02dad771=""> <div class=row _v-02dad771=""> <div class="col-xs-12 col-sm-4 col-md-4 col-lg-4 col-xl-4" _v-02dad771=""> <video id=localVideo _v-02dad771=""></video> </div> <div class="col-xs-12 col-sm-4 col-md-4 col-lg-4 col-xl-4" _v-02dad771=""> <video id=remoteVideo _v-02dad771=""></video> </div> <div class="col-xs-12 col-sm-4 col-md-4 col-lg-4 col-xl-4" _v-02dad771=""> <fieldset class=well _v-02dad771=""> <p class="head muted" _v-02dad771=""> Serverless WebRTC chat. </p> <div class=text-info id=chatlog style="height:350px; overflow:auto" _v-02dad771=""> </div> </fieldset> <form class=form-inline v-on:submit.prevent=sendMessage action="" _v-02dad771=""> <input type=text id=messageTextBox placeholder="Type your message here" _v-02dad771=""> <button type=submit id=sendMessageBtn class=btn _v-02dad771="">Send message</button> </form> </div> <div class="modal fade" id=showLocalOffer data-backdrop=static tabindex=-1 role=dialog aria-labelledby=myModalLabel aria-hidden=true hidden="" _v-02dad771=""> <div class=modal-dialog role=document _v-02dad771=""> <div class=modal-content _v-02dad771=""> <div class=modal-header _v-02dad771=""> <h3 id=myModalLabel _v-02dad771="">Send your local offer to someone else</h3> </div> <div class=modal-body _v-02dad771=""> Here\'s your "offer" -- it tells someone else how to connect to you. Send the whole thing to them, for example in an instant message or e-mail. <br _v-02dad771=""> <textarea class=input-large id=localOffer name=localOffer rows=10 cols=100 _v-02dad771=""></textarea> </div> <div class=modal-footer _v-02dad771=""> <button class="btn btn-primary" id=offerSentBtn data-dismiss=modal aria-hidden=true _v-02dad771="">Okay, I sent it.</button> </div> </div> </div> </div> <div class="modal fade" id=showLocalAnswer data-backdrop=static tabindex=-1 role=dialog aria-labelledby=myModalLabel aria-hidden=true hidden="" _v-02dad771=""> <div class=modal-dialog role=document _v-02dad771=""> <div class=modal-content _v-02dad771=""> <div class=modal-header _v-02dad771=""> <h3 id=myModalLabel _v-02dad771="">Send your local answer to someone else</h3> </div> <div class=modal-body _v-02dad771=""> Here\'s your "answer" -- it tells someone else how to connect to you. Send the whole thing to them, for example in an instant message or e-mail. <br _v-02dad771=""> <textarea class=input-large id=localAnswer name=localAnswer rows=10 cols=100 _v-02dad771=""></textarea> </div> <div class=modal-footer _v-02dad771=""> <button class="btn btn-primary" id=answerSentBtn data-dismiss=modal aria-hidden=true _v-02dad771="">Okay, I sent it.</button> </div> </div> </div> </div> <div class="modal fad" id=getRemoteOffer data-backdrop=static tabindex=-1 role=dialog aria-labelledby=myModalLabel aria-hidden=true hidden="" _v-02dad771=""> <div class=modal-dialog role=document _v-02dad771=""> <div class=modal-content _v-02dad771=""> <div class=modal-header _v-02dad771=""> <h3 id=myModalLabel _v-02dad771="">Paste the "offer" you received</h3> </div> <div class=modal-body _v-02dad771=""> The person who created the room will send you an "offer" string -- paste it here. <br _v-02dad771=""> <textarea class=input-large id=remoteOffer name=remoteOffer rows=10 cols=100 _v-02dad771=""></textarea> </div> <div class=modal-footer _v-02dad771=""> <button class="btn btn-primary" id=offerRecdBtn data-dismiss=modal aria-hidden=true _v-02dad771="">Okay, I pasted it.</button> </div> </div> </div> </div> <div class="modal fade" id=getRemoteAnswer data-backdrop=static tabindex=-1 role=dialog aria-labelledby=myModalLabel aria-hidden=true hidden="" _v-02dad771=""> <div class=modal-dialog role=document _v-02dad771=""> <div class=modal-content _v-02dad771=""> <div class=modal-header _v-02dad771=""> <h3 id=myModalLabel _v-02dad771="">Paste the "answer" you received</h3> </div> <div class=modal-body _v-02dad771=""> Now paste in the "answer" that was sent back to you. <br _v-02dad771=""> <textarea class=input-large id=remoteAnswer name=remoteAnswer rows=10 cols=100 _v-02dad771=""></textarea> </div> <div class=modal-footer _v-02dad771=""> <button class="btn btn-primary" id=answerRecdBtn data-dismiss=modal aria-hidden=true _v-02dad771="">Okay, I pasted it.</button> </div> </div> </div> </div> <div class="modal fade" id=waitForConnection data-backdrop=static tabindex=-1 role=dialog aria-labelledby=myModalLabel aria-hidden=true hidden="" _v-02dad771=""> <div class=modal-dialog role=document _v-02dad771=""> <div class=modal-content _v-02dad771=""> <div class=modal-header _v-02dad771=""> <h3 id=myModalLabel _v-02dad771="">Waiting for connection</h3> </div> <div class=modal-body _v-02dad771=""> This dialog will disappear when a connection is made. </div> <div class=spinner align=center _v-02dad771=""> <img src='+a(1)+' _v-02dad771=""> </div> </div> </div> </div> <div class="modal fade" id=createOrJoin data-backdrop=static tabindex=-1 role=dialog aria-labelledby=myModalLabel aria-hidden=true _v-02dad771=""> <div class=modal-dialog role=document _v-02dad771=""> <div class=modal-content _v-02dad771=""> <div class=modal-header _v-02dad771=""> <h3 id=myModalLabel _v-02dad771="">Create or join a room?</h3> </div> <div class=modal-footer _v-02dad771=""> <button class=btn id=joinBtn data-dismiss=modal aria-hidden=true _v-02dad771="">Join</button> <button class="btn btn-primary" id=createBtn data-dismiss=modal aria-hidden=true _v-02dad771="">Create</button> </div> </div> </div> </div> </div> </div> <div v-else="" class=spinner align=center _v-02dad771=""> <img src='+a(1)+' _v-02dad771=""> </div> '},function(e,o,a){var t,n;a(7),t=a(2),n=a(9),e.exports=t||{},e.exports.__esModule&&(e.exports=e.exports["default"]),n&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=n)},function(e,o,a){var t,n;a(8),t=a(3),n=a(10),e.exports=t||{},e.exports.__esModule&&(e.exports=e.exports["default"]),n&&(("function"==typeof e.exports?e.exports.options||(e.exports.options={}):e.exports).template=n)}]);
//# sourceMappingURL=app.0692a333d88f2404fea8.js.map